<section class="pt-20 pb-10 bg-gray-50 min-h-screen">
  <div class="container xl:w-[90%] mx-auto px-4">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold text-gray-800">
        <i class="fas fa-shopping-cart text-green-600 mr-2"></i>
        Shopping Cart
      </h2>
      @if (cartData() && cartData()!.products.length > 0) {
        <span class="text-sm text-gray-600">{{ cartData()!.products.length }} items</span>
      }
    </div>

    @if (cartData() && cartData()!.products.length > 0) {
      <div class="grid lg:grid-cols-3 gap-6">
        <!-- Cart Items Section -->
        <div class="lg:col-span-2 space-y-3">
          @for (item of cartData()!.products; track item._id) {
            <!-- Cart Item Card -->
            <div
              class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 p-4 border border-gray-100"
            >
              <div class="flex gap-4">
                <!-- Product Image -->
                <div class="relative w-20 h-20 shrink-0 bg-gray-50 rounded-lg overflow-hidden">
                  <img
                    [src]="item.product.imageCover"
                    [alt]="item.product.title"
                    class="w-full h-full object-cover"
                  />
                </div>

                <!-- Product Details -->
                <div class="grow">
                  <div class="flex justify-between items-start mb-1">
                    <div class="flex-1">
                      <h3 class="text-base font-semibold text-gray-800 line-clamp-1 mb-1">
                        {{ item.product.title }}
                      </h3>
                      <p class="text-xs text-gray-500">{{ item.product.category.name }}</p>
                    </div>
                    <button
                      class="ml-2 w-8 h-8 cursor-pointer flex items-center justify-center text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all duration-200"
                      (click)="removeItem(item.product.id)"
                    >
                      <i class="fa-solid fa-trash text-sm"></i>
                    </button>
                  </div>

                  <div class="flex items-center justify-between mt-3">
                    <span class="text-lg font-bold text-green-600">{{
                      item.price | currency: 'GBP'
                    }}</span>

                    <!-- Quantity Controls -->
                    <div
                      class="flex items-center gap-2 bg-gray-50 rounded-lg border border-gray-200"
                    >
                      <button
                        class="w-8 h-8 cursor-pointer flex items-center justify-center text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-l-lg transition-all duration-200"
                        (click)="decreaseQuantity(item.product.id, item.count)"
                      >
                        <i class="fa-solid fa-minus text-xs"></i>
                      </button>
                      <span class="font-semibold text-gray-800 min-w-8 text-center text-sm">{{
                        item.count
                      }}</span>
                      <button
                        class="w-8 h-8 cursor-pointer flex items-center justify-center text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-r-lg transition-all duration-200"
                        (click)="increaseQuantity(item.product.id, item.count)"
                      >
                        <i class="fa-solid fa-plus text-xs"></i>
                      </button>
                    </div>
                  </div>

                  <!-- Item Total -->
                  <div class="mt-2 text-right">
                    <span class="text-xs text-gray-500">Item Total: </span>
                    <span class="text-sm font-semibold text-gray-800">{{
                      item.price * item.count | currency: 'GBP'
                    }}</span>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>

        <!-- Order Summary Section -->
        <div class="lg:col-span-1">
          <div class="bg-white rounded-lg shadow-sm p-5 sticky top-24 border border-gray-100">
            <h3 class="text-lg font-bold text-gray-800 mb-4 pb-3 border-b">Order Summary</h3>

            <div class="space-y-3 mb-4">
              <div class="flex justify-between text-sm text-gray-600">
                <span>Subtotal ({{ cartData()!.products.length }} items)</span>
                <span class="font-semibold text-gray-800">{{
                  cartData()!.totalCartPrice | currency: 'GBP'
                }}</span>
              </div>
              <div class="flex justify-between text-sm text-gray-600">
                <span>Shipping</span>
                <span class="font-semibold text-green-600">Free</span>
              </div>
              <div class="border-t pt-3 mt-3">
                <div class="flex justify-between items-center">
                  <span class="text-base font-bold text-gray-800">Total</span>
                  <span class="text-2xl font-bold text-green-600">{{
                    cartData()!.totalCartPrice | currency: 'GBP'
                  }}</span>
                </div>
              </div>
            </div>

            <!-- Checkout Buttons -->
            <div class="space-y-2">
              <!-- Online Payment Button -->
              <button
                class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md flex items-center justify-center gap-2"
                [routerLink]="['/checkout',cartData()?._id]"
              >
                <i class="fas fa-credit-card text-sm"></i>
                Pay Online
              </button>

              <!-- Cash Order Button -->
              <button
                (click)="createCashOrder()"
                class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md flex items-center justify-center gap-2"
              >
                <i class="fas fa-money-bill-wave text-sm"></i>
                Cash on Delivery
              </button>
            </div>

            <!-- Continue Shopping -->
            <button
              class="w-full border border-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors duration-200 flex items-center justify-center gap-2 mt-2"
              routerLink="/products"
            >
              <i class="fas fa-arrow-left text-sm"></i>
              Continue Shopping
            </button>
          </div>
        </div>
      </div>
    } @else {
      <!-- Empty Cart State -->
      <div class="bg-white rounded-lg shadow-sm p-12 text-center border border-gray-100">
        <div class="mb-6">
          <i class="fa-solid fa-cart-shopping text-gray-300 text-7xl"></i>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-2">Your cart is empty</h3>
        <p class="text-gray-500 mb-6">Looks like you haven't added anything to your cart yet</p>
        <button
          class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors duration-200 inline-flex items-center gap-2"
          routerLink="/products"
        >
          <i class="fas fa-shopping-bag"></i>
          Start Shopping
        </button>
      </div>
    }
  </div>
</section>
